_format_version: "3.0"
_transform: true

plugins:
  - name: cors
    config:
      origins:
        - "http://localhost:5173"
        #websocket testing
        - "http://127.0.0.1:3000"
      methods:
        - GET
        - POST
        - OPTIONS
        - PUT
        - PATCH
        - DELETE
      credentials: true

services:
  - name: auth-service
    url: http://auth-service:3001
    routes:
      - name: auth-route
        paths:
          - /api/auth
        strip_path: false

  - name: user-service
    url: http://user-service:3002
    routes:
      - name: user-route
        paths:
          - /api/users
        strip_path: false

  - name: course-service
    url: http://course-service:3003
    routes:
      - name: course-route
        paths:
          - /api/courses
        strip_path: false
      - name: enrollment-route
        paths:
          - /api/enrollments
        strip_path: false

  - name: upload-service
    url: http://upload-service:3004
    routes:
      - name: upload-route
        paths:
          - /api/uploads
        strip_path: false

  - name: payment-service
    url: http://payment-service:3006
    routes:
      - name: payment-route
        paths:
          - /api/payments
        strip_path: false

  - name: session-service
    url: http://session-service:3008
    routes:
      - name: session-route
        paths:
          - /api/sessions
        strip_path: false

  - name: chat-service
    url: http://chat-service:3007
    routes:
      - name: chat-rest-route
        paths:
          - /api/chats
        strip_path: false
      - name: chat-websocket-route
        paths:
          - /ws/
        strip_path: false

  - name: notification-service
    url: http://notification-service:3010
    routes:
      - name: notification-rest-route
        paths:
          - /api/notifications
        strip_path: false
